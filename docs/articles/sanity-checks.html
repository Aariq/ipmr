<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sanity checks for ipmr examples â€¢ ipmr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Sanity checks for ipmr examples">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ipmr</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/general-ipms.html">General IPMs</a>
    </li>
    <li>
      <a href="../articles/generic-funs.html">List of Generic and Helper Functions in ipmr</a>
    </li>
    <li>
      <a href="../articles/hierarchical-notation.html">Hierarchical Notation</a>
    </li>
    <li>
      <a href="../articles/ipmr-introduction.html">Introduction to ipmr</a>
    </li>
    <li>
      <a href="../articles/proto-ipms.html">proto_ipm data structure</a>
    </li>
    <li>
      <a href="../articles/sanity-checks.html">Sanity checks for ipmr examples</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Sanity checks for ipmr examples</h1>
            
      
      
      <div class="hidden name"><code>sanity-checks.Rmd</code></div>

    </div>

    
    
<div id="the-simple-density-independent-deterministic-model-from-the-readme" class="section level2">
<h2 class="hasAnchor">
<a href="#the-simple-density-independent-deterministic-model-from-the-readme" class="anchor"></a>The simple, density-independent, deterministic model from the README</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># Load ipmr and get the parameter values. The data_list argument for define_kernel</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co"># should hold every regression parameter and every constant used in the model.</span></a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ipmr)</a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6">data_list =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">s_int     =</span> <span class="fl">2.2</span>,   <span class="co"># coefficients(my_surv_mod)[1]</span></a>
<a class="sourceLine" id="cb1-7" title="7">                 <span class="dt">s_slope   =</span> <span class="fl">0.25</span>,  <span class="co"># coefficients(my_surv_mod)[2]</span></a>
<a class="sourceLine" id="cb1-8" title="8">                 <span class="dt">g_int     =</span> <span class="fl">0.2</span>,   <span class="co"># coefficients(my_grow_mod)[1]</span></a>
<a class="sourceLine" id="cb1-9" title="9">                 <span class="dt">g_slope   =</span> <span class="fl">1.02</span>,  <span class="co"># coefficients(my_grow_mod)[2]</span></a>
<a class="sourceLine" id="cb1-10" title="10">                 <span class="dt">sd_g      =</span> <span class="fl">0.7</span>,   <span class="co"># sd(resid(my_grow_mod))</span></a>
<a class="sourceLine" id="cb1-11" title="11">                 <span class="dt">f_r_int   =</span> <span class="fl">0.003</span>, <span class="co"># coefficients(my_pr_flower_mod)[1]</span></a>
<a class="sourceLine" id="cb1-12" title="12">                 <span class="dt">f_r_slope =</span> <span class="fl">0.015</span>, <span class="co"># coefficients(my_pr_flower_mod)[2]</span></a>
<a class="sourceLine" id="cb1-13" title="13">                 <span class="dt">f_s_int   =</span> <span class="fl">1.3</span>,   <span class="co"># coefficients(my_seed_mod)[1]</span></a>
<a class="sourceLine" id="cb1-14" title="14">                 <span class="dt">f_s_slope =</span> <span class="fl">0.075</span>, <span class="co"># coefficients(my_seed_mod)[2]</span></a>
<a class="sourceLine" id="cb1-15" title="15">                 <span class="dt">mu_fd     =</span> <span class="dv">2</span>,     <span class="co"># mean(recruit_data$size_next)</span></a>
<a class="sourceLine" id="cb1-16" title="16">                 <span class="dt">sd_fd     =</span> <span class="fl">0.3</span>)   <span class="co"># sd(recruit_data$size_next)</span></a>
<a class="sourceLine" id="cb1-17" title="17"></a>
<a class="sourceLine" id="cb1-18" title="18">my_simple_ipm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/init_ipm.html">init_ipm</a></span>(<span class="st">'simple_di_det'</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-19" title="19"><span class="st">  </span><span class="kw"><a href="../reference/kernel-definitions.html">define_kernel</a></span>(</a>
<a class="sourceLine" id="cb1-20" title="20">    </a>
<a class="sourceLine" id="cb1-21" title="21">    <span class="co"># Name of the kernel</span></a>
<a class="sourceLine" id="cb1-22" title="22">    </a>
<a class="sourceLine" id="cb1-23" title="23">    <span class="dt">name      =</span> <span class="st">"P_simple"</span>,</a>
<a class="sourceLine" id="cb1-24" title="24">    </a>
<a class="sourceLine" id="cb1-25" title="25">    <span class="co"># The type of transition it describes (e.g. continuous - continuous, discrete - continuous).</span></a>
<a class="sourceLine" id="cb1-26" title="26">    <span class="co"># These must be specified for all kernels!</span></a>
<a class="sourceLine" id="cb1-27" title="27">    </a>
<a class="sourceLine" id="cb1-28" title="28">    <span class="dt">family    =</span> <span class="st">"CC"</span>,</a>
<a class="sourceLine" id="cb1-29" title="29">    </a>
<a class="sourceLine" id="cb1-30" title="30">    <span class="co"># The formula for the kernel. </span></a>
<a class="sourceLine" id="cb1-31" title="31">    </a>
<a class="sourceLine" id="cb1-32" title="32">    <span class="dt">formula   =</span> s <span class="op">*</span><span class="st"> </span>g,</a>
<a class="sourceLine" id="cb1-33" title="33">    </a>
<a class="sourceLine" id="cb1-34" title="34">    <span class="co"># A named set of expressions for the vital rates it includes. </span></a>
<a class="sourceLine" id="cb1-35" title="35">    <span class="co"># note the use of user-specified functions here. Additionally, each </span></a>
<a class="sourceLine" id="cb1-36" title="36">    <span class="co"># state variable has a stateVariable_1 and stateVariable_2 internally defined</span></a>
<a class="sourceLine" id="cb1-37" title="37">    <span class="co"># for the domain associated with it. Use these to distinguish between </span></a>
<a class="sourceLine" id="cb1-38" title="38">    <span class="co"># size/weight/etc at time t vs size/weight/etc at time t+1</span></a>
<a class="sourceLine" id="cb1-39" title="39">    </a>
<a class="sourceLine" id="cb1-40" title="40">    <span class="co"># Perform the inverse logit transformation to get survival probabilities</span></a>
<a class="sourceLine" id="cb1-41" title="41">    <span class="co"># from your model. For examples on using predict(my_surv_mod,...),</span></a>
<a class="sourceLine" id="cb1-42" title="42">    <span class="co"># see below.</span></a>
<a class="sourceLine" id="cb1-43" title="43">    </a>
<a class="sourceLine" id="cb1-44" title="44">    <span class="dt">s         =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="op">-</span>(s_int <span class="op">+</span><span class="st"> </span>s_slope <span class="op">*</span><span class="st"> </span>dbh_<span class="dv">1</span>))), </a>
<a class="sourceLine" id="cb1-45" title="45">    </a>
<a class="sourceLine" id="cb1-46" title="46">    <span class="co"># The growth model requires a function to compute the mean as a function of dbh.</span></a>
<a class="sourceLine" id="cb1-47" title="47">    <span class="co"># The SD is a constant, so we don't need to define that in ... expression, </span></a>
<a class="sourceLine" id="cb1-48" title="48">    <span class="co"># just the data_list.</span></a>
<a class="sourceLine" id="cb1-49" title="49">    </a>
<a class="sourceLine" id="cb1-50" title="50">    <span class="dt">g         =</span> <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span>(dbh_<span class="dv">2</span>, mu_g, sd_g),</a>
<a class="sourceLine" id="cb1-51" title="51">    <span class="dt">mu_g      =</span> g_int <span class="op">+</span><span class="st"> </span>g_slope <span class="op">*</span><span class="st"> </span>dbh_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1-52" title="52"></a>
<a class="sourceLine" id="cb1-53" title="53">    </a>
<a class="sourceLine" id="cb1-54" title="54">    <span class="co"># Specify the constants in the model in the data_list. </span></a>
<a class="sourceLine" id="cb1-55" title="55">    </a>
<a class="sourceLine" id="cb1-56" title="56">    <span class="dt">data_list =</span> data_list,</a>
<a class="sourceLine" id="cb1-57" title="57">    <span class="dt">states    =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'dbh'</span>)),</a>
<a class="sourceLine" id="cb1-58" title="58">    </a>
<a class="sourceLine" id="cb1-59" title="59">    <span class="co"># If you want to correct for eviction, set evict = TRUE and specify an</span></a>
<a class="sourceLine" id="cb1-60" title="60">    <span class="co"># evict_fun. ipmr provides truncated_distributions() to help.</span></a>
<a class="sourceLine" id="cb1-61" title="61">    </a>
<a class="sourceLine" id="cb1-62" title="62">    <span class="dt">evict     =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb1-63" title="63">    <span class="dt">evict_fun =</span> <span class="kw"><a href="../reference/eviction.html">truncated_distributions</a></span>(<span class="st">'norm'</span>,</a>
<a class="sourceLine" id="cb1-64" title="64">                                        <span class="st">'g'</span>)</a>
<a class="sourceLine" id="cb1-65" title="65">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-66" title="66"><span class="st">  </span><span class="kw"><a href="../reference/kernel-definitions.html">define_kernel</a></span>(<span class="st">'F_simple'</span>,</a>
<a class="sourceLine" id="cb1-67" title="67">                <span class="dt">formula   =</span> f_r <span class="op">*</span><span class="st"> </span>f_s <span class="op">*</span><span class="st"> </span>f_d,</a>
<a class="sourceLine" id="cb1-68" title="68">                <span class="dt">family    =</span> <span class="st">'CC'</span>,</a>
<a class="sourceLine" id="cb1-69" title="69">                </a>
<a class="sourceLine" id="cb1-70" title="70">                <span class="co"># Inverse logit transformation for flowering probability</span></a>
<a class="sourceLine" id="cb1-71" title="71">                <span class="co"># (because we used a logistic regression)</span></a>
<a class="sourceLine" id="cb1-72" title="72">                </a>
<a class="sourceLine" id="cb1-73" title="73">                <span class="dt">f_r       =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>( <span class="op">-</span><span class="st"> </span>(f_r_int <span class="op">+</span><span class="st"> </span>f_r_slope <span class="op">*</span><span class="st"> </span>dbh_<span class="dv">1</span>))),</a>
<a class="sourceLine" id="cb1-74" title="74">                </a>
<a class="sourceLine" id="cb1-75" title="75">                <span class="co"># Exponential function for seed progression </span></a>
<a class="sourceLine" id="cb1-76" title="76">                <span class="co"># (because we used a Poisson)</span></a>
<a class="sourceLine" id="cb1-77" title="77">                </a>
<a class="sourceLine" id="cb1-78" title="78">                <span class="dt">f_s       =</span> <span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(f_s_int <span class="op">+</span><span class="st"> </span>f_s_slope <span class="op">*</span><span class="st"> </span>dbh_<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1-79" title="79">                </a>
<a class="sourceLine" id="cb1-80" title="80">                <span class="co"># The recruit size distribution has no maternal effect for size,</span></a>
<a class="sourceLine" id="cb1-81" title="81">                <span class="co"># so mu_fd and sd_fd are constants. These get passed in the </span></a>
<a class="sourceLine" id="cb1-82" title="82">                <span class="co"># data_list</span></a>
<a class="sourceLine" id="cb1-83" title="83">                </a>
<a class="sourceLine" id="cb1-84" title="84">                <span class="dt">f_d       =</span> <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span>(dbh_<span class="dv">2</span>, mu_fd, sd_fd),</a>
<a class="sourceLine" id="cb1-85" title="85">                <span class="dt">data_list =</span> data_list,</a>
<a class="sourceLine" id="cb1-86" title="86">                <span class="dt">states    =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'dbh'</span>)),</a>
<a class="sourceLine" id="cb1-87" title="87">                </a>
<a class="sourceLine" id="cb1-88" title="88">                <span class="co"># Again, we'll correct for eviction in new recruits by</span></a>
<a class="sourceLine" id="cb1-89" title="89">                <span class="co"># truncating the normal distribution.</span></a>
<a class="sourceLine" id="cb1-90" title="90">                </a>
<a class="sourceLine" id="cb1-91" title="91">                <span class="dt">evict     =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb1-92" title="92">                <span class="dt">evict_fun =</span> <span class="kw"><a href="../reference/eviction.html">truncated_distributions</a></span>(<span class="st">'norm'</span>,</a>
<a class="sourceLine" id="cb1-93" title="93">                                                    <span class="st">'f_d'</span>)</a>
<a class="sourceLine" id="cb1-94" title="94">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-95" title="95"><span class="st">  </span></a>
<a class="sourceLine" id="cb1-96" title="96"><span class="st">  </span><span class="co"># K kernels get their own special define_k function. Rather than use the formula</span></a>
<a class="sourceLine" id="cb1-97" title="97"><span class="st">  </span><span class="co"># parameter, it simply takes named expressions for the format of the iteration</span></a>
<a class="sourceLine" id="cb1-98" title="98"><span class="st">  </span><span class="co"># kernels. It can also take expressions showing how these kernels generate </span></a>
<a class="sourceLine" id="cb1-99" title="99"><span class="st">  </span><span class="co"># population states at t+1 as a function of population state at t - see examples</span></a>
<a class="sourceLine" id="cb1-100" title="100"><span class="st">  </span><span class="co"># below for how to do that.</span></a>
<a class="sourceLine" id="cb1-101" title="101"><span class="st">  </span></a>
<a class="sourceLine" id="cb1-102" title="102"><span class="st">  </span><span class="kw"><a href="../reference/kernel-definitions.html">define_k</a></span>(<span class="st">'K'</span>,</a>
<a class="sourceLine" id="cb1-103" title="103">           <span class="dt">K         =</span> P_simple <span class="op">+</span><span class="st"> </span>F_simple,</a>
<a class="sourceLine" id="cb1-104" title="104">           </a>
<a class="sourceLine" id="cb1-105" title="105">           <span class="co"># This is a new family - at the moment all K's will get the</span></a>
<a class="sourceLine" id="cb1-106" title="106">           <span class="co"># 'IPM' family</span></a>
<a class="sourceLine" id="cb1-107" title="107">           </a>
<a class="sourceLine" id="cb1-108" title="108">           <span class="dt">family    =</span> <span class="st">'IPM'</span>,</a>
<a class="sourceLine" id="cb1-109" title="109">           </a>
<a class="sourceLine" id="cb1-110" title="110">           <span class="co"># This kernel has no additional parameters, so the data_list</span></a>
<a class="sourceLine" id="cb1-111" title="111">           <span class="co"># is empty</span></a>
<a class="sourceLine" id="cb1-112" title="112">           </a>
<a class="sourceLine" id="cb1-113" title="113">           <span class="dt">data_list =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(),</a>
<a class="sourceLine" id="cb1-114" title="114">           <span class="dt">states    =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'dbh'</span>)),</a>
<a class="sourceLine" id="cb1-115" title="115">           <span class="co"># We've already corrected eviction in the sub-kernels, so there's no</span></a>
<a class="sourceLine" id="cb1-116" title="116">           <span class="co"># need to do that here</span></a>
<a class="sourceLine" id="cb1-117" title="117">           <span class="dt">evict     =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb1-118" title="118">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-119" title="119"><span class="st">  </span><span class="co"># Next, we have to define the implementation details for the model. </span></a>
<a class="sourceLine" id="cb1-120" title="120"><span class="st">  </span><span class="co"># We need to tell ipmr how each kernel is integrated, what domain</span></a>
<a class="sourceLine" id="cb1-121" title="121"><span class="st">  </span><span class="co"># it starts on (i.e. the size/weight/etc from above), and what domain</span></a>
<a class="sourceLine" id="cb1-122" title="122"><span class="st">  </span><span class="co"># it ends on. In simple_* models, dom_start and dom_end will always be the same,</span></a>
<a class="sourceLine" id="cb1-123" title="123"><span class="st">  </span><span class="co"># because we only have a single continuous state variable. General_*</span></a>
<a class="sourceLine" id="cb1-124" title="124"><span class="st">  </span><span class="co"># models will be more complicated.</span></a>
<a class="sourceLine" id="cb1-125" title="125"><span class="st">  </span></a>
<a class="sourceLine" id="cb1-126" title="126"><span class="st">  </span><span class="kw"><a href="../reference/define_star.html">define_impl</a></span>(</a>
<a class="sourceLine" id="cb1-127" title="127">    <span class="kw"><a href="../reference/define_star.html">make_impl_args_list</a></span>(</a>
<a class="sourceLine" id="cb1-128" title="128">      <span class="dt">kernel_names =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"K_simple"</span>, <span class="st">"P_simple"</span>, <span class="st">"F_simple"</span>),</a>
<a class="sourceLine" id="cb1-129" title="129">      <span class="dt">int_rule     =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"midpoint"</span>, <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb1-130" title="130">      <span class="dt">dom_start    =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"dbh"</span>, <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb1-131" title="131">      <span class="dt">dom_end      =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"dbh"</span>, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1-132" title="132">    )</a>
<a class="sourceLine" id="cb1-133" title="133">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-134" title="134"><span class="st">  </span><span class="kw"><a href="../reference/define_star.html">define_domains</a></span>(</a>
<a class="sourceLine" id="cb1-135" title="135">    <span class="dt">dbh =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="co"># the first entry is the lower bound of the domain.</span></a>
<a class="sourceLine" id="cb1-136" title="136">            <span class="dv">50</span>, <span class="co"># the second entry is the upper bound of the domain.</span></a>
<a class="sourceLine" id="cb1-137" title="137">            <span class="dv">100</span> <span class="co"># third entry is the number of meshpoints for the domain.</span></a>
<a class="sourceLine" id="cb1-138" title="138">    ) </a>
<a class="sourceLine" id="cb1-139" title="139">  )  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-140" title="140"><span class="st">  </span><span class="kw"><a href="../reference/make_ipm.html">make_ipm</a></span>()</a>
<a class="sourceLine" id="cb1-141" title="141"></a>
<a class="sourceLine" id="cb1-142" title="142"></a>
<a class="sourceLine" id="cb1-143" title="143">lambda_ipmr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/lambda.html">lambda</a></span>(my_simple_ipm, <span class="dt">comp_method =</span> <span class="st">'eigen'</span>)</a>
<a class="sourceLine" id="cb1-144" title="144">w_ipmr      &lt;-<span class="st"> </span><span class="kw"><a href="../reference/eigenvectors.html">right_ev</a></span>(my_simple_ipm)</a>
<a class="sourceLine" id="cb1-145" title="145"></a>
<a class="sourceLine" id="cb1-146" title="146"></a>
<a class="sourceLine" id="cb1-147" title="147"><span class="co"># Example of the setup for a simple IPM without density dependence or environmental</span></a>
<a class="sourceLine" id="cb1-148" title="148"><span class="co"># stochasticity</span></a>
<a class="sourceLine" id="cb1-149" title="149"></a>
<a class="sourceLine" id="cb1-150" title="150"><span class="co"># This chunk of code generates an IPM "by hand" so that we have something to compare ipmr's</span></a>
<a class="sourceLine" id="cb1-151" title="151"><span class="co"># output with</span></a>
<a class="sourceLine" id="cb1-152" title="152"></a>
<a class="sourceLine" id="cb1-153" title="153"><span class="co"># Survival function</span></a>
<a class="sourceLine" id="cb1-154" title="154">s &lt;-<span class="st"> </span><span class="cf">function</span>(sv1, params) {</a>
<a class="sourceLine" id="cb1-155" title="155">  <span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="op">-</span>(params[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>params[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>sv1)))</a>
<a class="sourceLine" id="cb1-156" title="156">}</a>
<a class="sourceLine" id="cb1-157" title="157"></a>
<a class="sourceLine" id="cb1-158" title="158"><span class="co"># growth function</span></a>
<a class="sourceLine" id="cb1-159" title="159">g &lt;-<span class="st"> </span><span class="cf">function</span>(sv1, sv2, params, L, U) {</a>
<a class="sourceLine" id="cb1-160" title="160">  mu &lt;-<span class="st"> </span>params[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>params[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>sv1</a>
<a class="sourceLine" id="cb1-161" title="161">  ev &lt;-<span class="st"> </span>(<span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(U, mu, params[<span class="dv">3</span>]) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(L, mu, params[<span class="dv">3</span>]))</a>
<a class="sourceLine" id="cb1-162" title="162">  <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span>(sv2, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> params[<span class="dv">3</span>]) <span class="op">/</span><span class="st"> </span>ev</a>
<a class="sourceLine" id="cb1-163" title="163">}</a>
<a class="sourceLine" id="cb1-164" title="164"></a>
<a class="sourceLine" id="cb1-165" title="165"></a>
<a class="sourceLine" id="cb1-166" title="166"><span class="co"># flowering probability</span></a>
<a class="sourceLine" id="cb1-167" title="167">f_r &lt;-<span class="st"> </span><span class="cf">function</span>(sv1, params) {</a>
<a class="sourceLine" id="cb1-168" title="168">  <span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="op">-</span>(params[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>params[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>sv1)))</a>
<a class="sourceLine" id="cb1-169" title="169">}</a>
<a class="sourceLine" id="cb1-170" title="170"></a>
<a class="sourceLine" id="cb1-171" title="171"><span class="co"># seed production</span></a>
<a class="sourceLine" id="cb1-172" title="172">f_s &lt;-<span class="st"> </span><span class="cf">function</span>(sv1, params) {</a>
<a class="sourceLine" id="cb1-173" title="173">  <span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(params[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>params[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>sv1)</a>
<a class="sourceLine" id="cb1-174" title="174">}</a>
<a class="sourceLine" id="cb1-175" title="175"></a>
<a class="sourceLine" id="cb1-176" title="176"><span class="co"># recruit size distribution</span></a>
<a class="sourceLine" id="cb1-177" title="177">f_d &lt;-<span class="st"> </span><span class="cf">function</span>(sv2, params) {</a>
<a class="sourceLine" id="cb1-178" title="178">  <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span>(sv2, <span class="dt">mean =</span> params[<span class="dv">1</span>], <span class="dt">sd =</span> params[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb1-179" title="179">}</a>
<a class="sourceLine" id="cb1-180" title="180"></a>
<a class="sourceLine" id="cb1-181" title="181"><span class="co"># F kernel function (combines f_r, f_s, and f_d while correcting for eviction)</span></a>
<a class="sourceLine" id="cb1-182" title="182">fec &lt;-<span class="st"> </span><span class="cf">function</span>(sv1, sv2, params, L, U) {</a>
<a class="sourceLine" id="cb1-183" title="183">  ev &lt;-<span class="st"> </span>(<span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(U, params[<span class="dv">5</span>], params[<span class="dv">6</span>]) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(L, params[<span class="dv">5</span>], params[<span class="dv">6</span>]))</a>
<a class="sourceLine" id="cb1-184" title="184">  <span class="kw">f_r</span>(sv1, params[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]) <span class="op">*</span><span class="st"> </span><span class="kw">f_s</span>(sv1, params[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>]) <span class="op">*</span><span class="st"> </span>(<span class="kw">f_d</span>(sv2, params[<span class="dv">5</span><span class="op">:</span><span class="dv">6</span>] <span class="op">/</span><span class="st"> </span>ev))</a>
<a class="sourceLine" id="cb1-185" title="185">}</a>
<a class="sourceLine" id="cb1-186" title="186"></a>
<a class="sourceLine" id="cb1-187" title="187"><span class="co"># Generate implementation arguments (mesh bounds, mid points, and sizes)</span></a>
<a class="sourceLine" id="cb1-188" title="188">b &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dt">length.out =</span> <span class="dv">101</span>)</a>
<a class="sourceLine" id="cb1-189" title="189">d1 &lt;-<span class="st"> </span>(b[<span class="dv">2</span><span class="op">:</span><span class="dv">101</span>] <span class="op">+</span><span class="st"> </span>b[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>]) <span class="op">*</span><span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb1-190" title="190">h &lt;-<span class="st"> </span>d1[<span class="dv">3</span>] <span class="op">-</span><span class="st"> </span>d1[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb1-191" title="191"></a>
<a class="sourceLine" id="cb1-192" title="192"><span class="co"># Expand the domains so they're fully crossed with each other. This replaces</span></a>
<a class="sourceLine" id="cb1-193" title="193"><span class="co"># outer() in typical IPM code, and has the benefit of being fully vectorized (</span></a>
<a class="sourceLine" id="cb1-194" title="194"><span class="co"># so a lot faster for larger meshes)</span></a>
<a class="sourceLine" id="cb1-195" title="195"></a>
<a class="sourceLine" id="cb1-196" title="196">domains &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">d2 =</span> d1, <span class="dt">d1 =</span> d1))</a>
<a class="sourceLine" id="cb1-197" title="197"></a>
<a class="sourceLine" id="cb1-198" title="198">G &lt;-<span class="st"> </span><span class="kw">g</span>(domains<span class="op">$</span>d2,</a>
<a class="sourceLine" id="cb1-199" title="199">       domains<span class="op">$</span>d1,</a>
<a class="sourceLine" id="cb1-200" title="200">       <span class="dt">params =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(data_list<span class="op">$</span>g_int,</a>
<a class="sourceLine" id="cb1-201" title="201">                  data_list<span class="op">$</span>g_slope,</a>
<a class="sourceLine" id="cb1-202" title="202">                  data_list<span class="op">$</span>sd_g),</a>
<a class="sourceLine" id="cb1-203" title="203">       <span class="dt">L =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb1-204" title="204">       <span class="dt">U =</span> <span class="dv">50</span>)</a>
<a class="sourceLine" id="cb1-205" title="205"></a>
<a class="sourceLine" id="cb1-206" title="206"></a>
<a class="sourceLine" id="cb1-207" title="207"></a>
<a class="sourceLine" id="cb1-208" title="208">S &lt;-<span class="st"> </span><span class="kw">s</span>(d1, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(data_list<span class="op">$</span>s_int, data_list<span class="op">$</span>s_slope))</a>
<a class="sourceLine" id="cb1-209" title="209"></a>
<a class="sourceLine" id="cb1-210" title="210">P &lt;-<span class="st"> </span>h <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(S <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(G))</a>
<a class="sourceLine" id="cb1-211" title="211"></a>
<a class="sourceLine" id="cb1-212" title="212">Fm &lt;-<span class="st"> </span>h <span class="op">*</span><span class="st"> </span><span class="kw">fec</span>(domains<span class="op">$</span>d2,</a>
<a class="sourceLine" id="cb1-213" title="213">              domains<span class="op">$</span>d1,</a>
<a class="sourceLine" id="cb1-214" title="214">              <span class="dt">params =</span> <span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(data_list[<span class="dv">6</span><span class="op">:</span><span class="dv">11</span>]),</a>
<a class="sourceLine" id="cb1-215" title="215">              <span class="dt">L =</span> <span class="dv">0</span>, <span class="dt">U =</span> <span class="dv">50</span>)</a>
<a class="sourceLine" id="cb1-216" title="216"></a>
<a class="sourceLine" id="cb1-217" title="217">K &lt;-<span class="st"> </span>P <span class="op">+</span><span class="st"> </span>Fm</a>
<a class="sourceLine" id="cb1-218" title="218"></a>
<a class="sourceLine" id="cb1-219" title="219">K &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(K, <span class="dt">nrow =</span> <span class="dv">100</span>, <span class="dt">ncol =</span> <span class="dv">100</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-220" title="220"></a>
<a class="sourceLine" id="cb1-221" title="221"></a>
<a class="sourceLine" id="cb1-222" title="222">lambda_usr &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/complex.html">Re</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span>(K)<span class="op">$</span>values[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb1-223" title="223">w &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/complex.html">Re</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span>(K)<span class="op">$</span>vectors[ , <span class="dv">1</span>])</a>
<a class="sourceLine" id="cb1-224" title="224">w &lt;-<span class="st"> </span>w <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(w)</a>
<a class="sourceLine" id="cb1-225" title="225"></a>
<a class="sourceLine" id="cb1-226" title="226">lambda_ipmr <span class="op">-</span><span class="st"> </span>lambda_usr</a>
<a class="sourceLine" id="cb1-227" title="227"></a>
<a class="sourceLine" id="cb1-228" title="228">w_ipmr<span class="op">$</span>dbh_w <span class="op">-</span><span class="st"> </span>w</a></code></pre></div>
</div>
<div id="simple-density-independent-stochastic-kernel-resampled-model-from-the-readme" class="section level2">
<h2 class="hasAnchor">
<a href="#simple-density-independent-stochastic-kernel-resampled-model-from-the-readme" class="anchor"></a>Simple density independent stochastic kernel resampled model from the README</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ipmr)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(purrr)</a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">50127</span>)</a>
<a class="sourceLine" id="cb2-5" title="5"></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co"># Define some fixed parameters</span></a>
<a class="sourceLine" id="cb2-7" title="7"></a>
<a class="sourceLine" id="cb2-8" title="8">data_list =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</a>
<a class="sourceLine" id="cb2-9" title="9">  <span class="dt">s_int     =</span> <span class="fl">1.03</span>,</a>
<a class="sourceLine" id="cb2-10" title="10">  <span class="dt">s_slope   =</span> <span class="fl">2.2</span>,</a>
<a class="sourceLine" id="cb2-11" title="11">  <span class="dt">g_int     =</span> <span class="dv">8</span>,</a>
<a class="sourceLine" id="cb2-12" title="12">  <span class="dt">g_slope   =</span> <span class="fl">0.92</span>,</a>
<a class="sourceLine" id="cb2-13" title="13">  <span class="dt">sd_g      =</span> <span class="fl">0.9</span>,</a>
<a class="sourceLine" id="cb2-14" title="14">  <span class="dt">f_r_int   =</span> <span class="fl">0.09</span>,</a>
<a class="sourceLine" id="cb2-15" title="15">  <span class="dt">f_r_slope =</span> <span class="fl">0.05</span>,</a>
<a class="sourceLine" id="cb2-16" title="16">  <span class="dt">f_s_int   =</span> <span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb2-17" title="17">  <span class="dt">f_s_slope =</span> <span class="fl">0.005</span>,</a>
<a class="sourceLine" id="cb2-18" title="18">  <span class="dt">mu_fd     =</span> <span class="dv">9</span>,</a>
<a class="sourceLine" id="cb2-19" title="19">  <span class="dt">sd_fd     =</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb2-20" title="20">)</a>
<a class="sourceLine" id="cb2-21" title="21"></a>
<a class="sourceLine" id="cb2-22" title="22"><span class="co"># Now, simulate some random intercepts for growth, survival, and offspring production.</span></a>
<a class="sourceLine" id="cb2-23" title="23"><span class="co"># For extracting random effects from real models, the following snippet should work</span></a>
<a class="sourceLine" id="cb2-24" title="24"><span class="co"># for most: </span></a>
<a class="sourceLine" id="cb2-25" title="25"></a>
<a class="sourceLine" id="cb2-26" title="26"><span class="co"># t(ranef(my_grow_mod))</span></a>
<a class="sourceLine" id="cb2-27" title="27"></a>
<a class="sourceLine" id="cb2-28" title="28"><span class="co"># The ranef() function is generic, and so whether it exists or not depends on </span></a>
<a class="sourceLine" id="cb2-29" title="29"><span class="co"># the package used to fit the vital rate regression. A google search for</span></a>
<a class="sourceLine" id="cb2-30" title="30"><span class="co"># "extract random effect estimates from class(insert_your_model_here) in R"</span></a>
<a class="sourceLine" id="cb2-31" title="31"><span class="co"># should get you close to the code you need.</span></a>
<a class="sourceLine" id="cb2-32" title="32"></a>
<a class="sourceLine" id="cb2-33" title="33">g_r_int   &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="fl">0.3</span>) </a>
<a class="sourceLine" id="cb2-34" title="34">s_r_int   &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb2-35" title="35">f_s_r_int &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb2-36" title="36"></a>
<a class="sourceLine" id="cb2-37" title="37"><span class="co"># Now, generate parameter names for each set of random effect estimates. </span></a>
<a class="sourceLine" id="cb2-38" title="38"></a>
<a class="sourceLine" id="cb2-39" title="39">nms &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"r_"</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">sep =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb2-40" title="40"></a>
<a class="sourceLine" id="cb2-41" title="41"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(g_r_int)   &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">'g_'</span>, nms, <span class="dt">sep =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb2-42" title="42"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(s_r_int)   &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">'s_'</span>, nms, <span class="dt">sep =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb2-43" title="43"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(f_s_r_int) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">'f_s_'</span>, nms, <span class="dt">sep =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb2-44" title="44"></a>
<a class="sourceLine" id="cb2-45" title="45"><span class="co"># Each set of parameters is converted to a named list. The names should match</span></a>
<a class="sourceLine" id="cb2-46" title="46"><span class="co"># the variables referenced in each define_kernel()/define_k() call.</span></a>
<a class="sourceLine" id="cb2-47" title="47"></a>
<a class="sourceLine" id="cb2-48" title="48">g_params   &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">as.list</a></span>(g_r_int)</a>
<a class="sourceLine" id="cb2-49" title="49">s_params   &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">as.list</a></span>(s_r_int)</a>
<a class="sourceLine" id="cb2-50" title="50">f_s_params &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">as.list</a></span>(f_s_r_int)</a>
<a class="sourceLine" id="cb2-51" title="51"></a>
<a class="sourceLine" id="cb2-52" title="52"><span class="co"># purrr::splice combines each separate list into one without creating any </span></a>
<a class="sourceLine" id="cb2-53" title="53"><span class="co"># additional depth to it. This keeps things a bit tidier.</span></a>
<a class="sourceLine" id="cb2-54" title="54"></a>
<a class="sourceLine" id="cb2-55" title="55">params     &lt;-<span class="st"> </span><span class="kw">splice</span>(data_list, g_params, s_params, f_s_params)</a>
<a class="sourceLine" id="cb2-56" title="56"></a>
<a class="sourceLine" id="cb2-57" title="57"><span class="co">## Now, let's get to the ipmr model</span></a>
<a class="sourceLine" id="cb2-58" title="58"></a>
<a class="sourceLine" id="cb2-59" title="59"><span class="co"># This example will use additional 'usr_funs' to be passed into make_ipm(). </span></a>
<a class="sourceLine" id="cb2-60" title="60"></a>
<a class="sourceLine" id="cb2-61" title="61">inv_logit &lt;-<span class="st"> </span><span class="cf">function</span>(sv, int, slope) {</a>
<a class="sourceLine" id="cb2-62" title="62">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(</a>
<a class="sourceLine" id="cb2-63" title="63">    <span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="op">-</span>(int <span class="op">+</span><span class="st"> </span>slope <span class="op">*</span><span class="st"> </span>sv)))</a>
<a class="sourceLine" id="cb2-64" title="64">  )</a>
<a class="sourceLine" id="cb2-65" title="65">}</a>
<a class="sourceLine" id="cb2-66" title="66"></a>
<a class="sourceLine" id="cb2-67" title="67">inv_logit_r &lt;-<span class="st"> </span><span class="cf">function</span>(sv, int, slope, r_eff) {</a>
<a class="sourceLine" id="cb2-68" title="68">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(</a>
<a class="sourceLine" id="cb2-69" title="69">    <span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="op">-</span>(int <span class="op">+</span><span class="st"> </span>slope <span class="op">*</span><span class="st"> </span>sv <span class="op">+</span><span class="st"> </span>r_eff)))</a>
<a class="sourceLine" id="cb2-70" title="70">  )</a>
<a class="sourceLine" id="cb2-71" title="71">}</a>
<a class="sourceLine" id="cb2-72" title="72"></a>
<a class="sourceLine" id="cb2-73" title="73">pois_r &lt;-<span class="st"> </span><span class="cf">function</span>(sv, int, slope, r_eff) {</a>
<a class="sourceLine" id="cb2-74" title="74">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(</a>
<a class="sourceLine" id="cb2-75" title="75">    <span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(</a>
<a class="sourceLine" id="cb2-76" title="76">      int <span class="op">+</span><span class="st"> </span>slope <span class="op">*</span><span class="st"> </span>sv <span class="op">+</span><span class="st"> </span>r_eff</a>
<a class="sourceLine" id="cb2-77" title="77">    )</a>
<a class="sourceLine" id="cb2-78" title="78">  )</a>
<a class="sourceLine" id="cb2-79" title="79">}</a>
<a class="sourceLine" id="cb2-80" title="80"></a>
<a class="sourceLine" id="cb2-81" title="81"><span class="co"># The "model_class" argument is now changed to reflect a different model type</span></a>
<a class="sourceLine" id="cb2-82" title="82"></a>
<a class="sourceLine" id="cb2-83" title="83">monocarp_sys &lt;-<span class="st"> </span><span class="kw"><a href="../reference/init_ipm.html">init_ipm</a></span>(<span class="st">'simple_di_stoch_kern'</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-84" title="84"><span class="st">  </span><span class="kw"><a href="../reference/kernel-definitions.html">define_kernel</a></span>(</a>
<a class="sourceLine" id="cb2-85" title="85">    </a>
<a class="sourceLine" id="cb2-86" title="86">    <span class="co"># The yr suffix is appended to the kernel name and the parameter names</span></a>
<a class="sourceLine" id="cb2-87" title="87">    <span class="co"># within each vital rate expression. ipmr substitutes in the hier_levels</span></a>
<a class="sourceLine" id="cb2-88" title="88">    <span class="co"># for each suffix occurrence, thus changing P_yr in P_1, P_2, P_3, P_4, P_5,</span></a>
<a class="sourceLine" id="cb2-89" title="89">    <span class="co"># s_yr in s_1, s_2, s_3, s_4, and s_5. s_r_yr is converted to s_r_1, s_r_2, </span></a>
<a class="sourceLine" id="cb2-90" title="90">    <span class="co"># etc. In the case of s_r_yr, provided that the names in the data_list match</span></a>
<a class="sourceLine" id="cb2-91" title="91">    <span class="co"># the expanded names, all will go well!</span></a>
<a class="sourceLine" id="cb2-92" title="92">    </a>
<a class="sourceLine" id="cb2-93" title="93">    <span class="dt">name             =</span> <span class="st">'P_yr'</span>,</a>
<a class="sourceLine" id="cb2-94" title="94">    </a>
<a class="sourceLine" id="cb2-95" title="95">    <span class="co"># The formula is updated to reflect that survival and growth</span></a>
<a class="sourceLine" id="cb2-96" title="96">    <span class="co"># vary from year to year. We append the _yr suffix to each to let ipmr know</span></a>
<a class="sourceLine" id="cb2-97" title="97">    <span class="co"># to expand the expression</span></a>
<a class="sourceLine" id="cb2-98" title="98">    </a>
<a class="sourceLine" id="cb2-99" title="99">    <span class="dt">formula          =</span> s_yr <span class="op">*</span><span class="st"> </span>g_yr ,</a>
<a class="sourceLine" id="cb2-100" title="100">    <span class="dt">family           =</span> <span class="st">"CC"</span>,</a>
<a class="sourceLine" id="cb2-101" title="101">    </a>
<a class="sourceLine" id="cb2-102" title="102">    <span class="co"># This is a monocarpic perennial, so flowering is fatal. Thus, in order</span></a>
<a class="sourceLine" id="cb2-103" title="103">    <span class="co"># to survive to t+1, you have to both survive AND not flower. Also, note</span></a>
<a class="sourceLine" id="cb2-104" title="104">    <span class="co"># the use of inv_logit_r and inv_logit functions that we defined above.</span></a>
<a class="sourceLine" id="cb2-105" title="105">    </a>
<a class="sourceLine" id="cb2-106" title="106">    <span class="dt">s_yr             =</span> <span class="kw">inv_logit_r</span>(ht_<span class="dv">1</span>, s_int, s_slope, s_r_yr) <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-107" title="107"><span class="st">                       </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">inv_logit</span>(ht_<span class="dv">1</span>, f_r_int, f_r_slope)),</a>
<a class="sourceLine" id="cb2-108" title="108">    </a>
<a class="sourceLine" id="cb2-109" title="109">    <span class="co"># Since the model for the mean of growth has a random year intercept,</span></a>
<a class="sourceLine" id="cb2-110" title="110">    <span class="co"># we modify all of these expressions as well to include the _yr</span></a>
<a class="sourceLine" id="cb2-111" title="111">    </a>
<a class="sourceLine" id="cb2-112" title="112">    <span class="dt">g_yr             =</span> <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span>(ht_<span class="dv">2</span>, mu_g_yr, sd_g),</a>
<a class="sourceLine" id="cb2-113" title="113">    <span class="dt">mu_g_yr          =</span> g_int <span class="op">+</span><span class="st"> </span>g_slope <span class="op">*</span><span class="st"> </span>ht_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>g_r_yr,</a>
<a class="sourceLine" id="cb2-114" title="114">    </a>
<a class="sourceLine" id="cb2-115" title="115">    <span class="dt">data_list        =</span> params,</a>
<a class="sourceLine" id="cb2-116" title="116">    <span class="dt">states           =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'ht'</span>)),</a>
<a class="sourceLine" id="cb2-117" title="117">    </a>
<a class="sourceLine" id="cb2-118" title="118">    <span class="co"># This where we tell ipmr that the model has hierarchical effects. </span></a>
<a class="sourceLine" id="cb2-119" title="119">    <span class="co"># The levels that it takes should specified in a named list. We're pretending</span></a>
<a class="sourceLine" id="cb2-120" title="120">    <span class="co"># this a random year effect, so we use the name 'yr'. This name can be whatever you</span></a>
<a class="sourceLine" id="cb2-121" title="121">    <span class="co"># want though.</span></a>
<a class="sourceLine" id="cb2-122" title="122">    </a>
<a class="sourceLine" id="cb2-123" title="123">    <span class="dt">has_hier_effs    =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb2-124" title="124">    <span class="dt">levels_hier_effs =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">yr =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>),</a>
<a class="sourceLine" id="cb2-125" title="125">    </a>
<a class="sourceLine" id="cb2-126" title="126">    <span class="co"># Again, correct for eviction. Note that the 2nd parameter is also modified</span></a>
<a class="sourceLine" id="cb2-127" title="127">    <span class="co"># with the _yr suffix</span></a>
<a class="sourceLine" id="cb2-128" title="128">    </a>
<a class="sourceLine" id="cb2-129" title="129">    <span class="dt">evict            =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb2-130" title="130">    <span class="dt">evict_fun        =</span> <span class="kw"><a href="../reference/eviction.html">truncated_distributions</a></span>(<span class="st">"norm"</span>, <span class="st">"g_yr"</span>)</a>
<a class="sourceLine" id="cb2-131" title="131">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-132" title="132"><span class="st">  </span><span class="kw"><a href="../reference/kernel-definitions.html">define_kernel</a></span>(</a>
<a class="sourceLine" id="cb2-133" title="133">    </a>
<a class="sourceLine" id="cb2-134" title="134">    <span class="co"># As above, we modify all the expressions that have a random effect with the _yr</span></a>
<a class="sourceLine" id="cb2-135" title="135">    <span class="co"># suffix to let ipmr know to expand those.</span></a>
<a class="sourceLine" id="cb2-136" title="136">    </a>
<a class="sourceLine" id="cb2-137" title="137">    <span class="dt">name             =</span> <span class="st">"F_yr"</span>,</a>
<a class="sourceLine" id="cb2-138" title="138">    <span class="dt">formula          =</span> f_r <span class="op">*</span><span class="st"> </span>f_s_yr <span class="op">*</span><span class="st"> </span>f_d,</a>
<a class="sourceLine" id="cb2-139" title="139">    <span class="dt">family           =</span> <span class="st">"CC"</span>,</a>
<a class="sourceLine" id="cb2-140" title="140">    <span class="dt">f_r              =</span> <span class="kw">inv_logit</span>(ht_<span class="dv">1</span>, f_r_int, f_r_slope),</a>
<a class="sourceLine" id="cb2-141" title="141">    <span class="dt">f_s_yr           =</span> <span class="kw">pois_r</span>(ht_<span class="dv">1</span>, f_s_int, f_s_slope, f_s_r_yr),</a>
<a class="sourceLine" id="cb2-142" title="142">    <span class="dt">f_d              =</span> <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span>(ht_<span class="dv">2</span>, mu_fd, sd_fd),</a>
<a class="sourceLine" id="cb2-143" title="143">    <span class="dt">data_list        =</span> params,</a>
<a class="sourceLine" id="cb2-144" title="144">    <span class="dt">states           =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'ht'</span>)), </a>
<a class="sourceLine" id="cb2-145" title="145">    <span class="dt">has_hier_effs    =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb2-146" title="146">    <span class="dt">levels_hier_effs =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">yr =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>),</a>
<a class="sourceLine" id="cb2-147" title="147">    <span class="dt">evict            =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb2-148" title="148">    <span class="dt">evict_fun        =</span> <span class="kw"><a href="../reference/eviction.html">truncated_distributions</a></span>(<span class="st">"norm"</span>, <span class="st">"f_d"</span>)</a>
<a class="sourceLine" id="cb2-149" title="149">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-150" title="150"><span class="st">  </span><span class="kw"><a href="../reference/kernel-definitions.html">define_k</a></span>(</a>
<a class="sourceLine" id="cb2-151" title="151">    <span class="dt">name             =</span> <span class="st">'K_yr'</span>,</a>
<a class="sourceLine" id="cb2-152" title="152">    <span class="dt">K_yr             =</span> P_yr <span class="op">+</span><span class="st"> </span>F_yr,</a>
<a class="sourceLine" id="cb2-153" title="153">    <span class="dt">family           =</span> <span class="st">"IPM"</span>,</a>
<a class="sourceLine" id="cb2-154" title="154">    <span class="dt">data_list        =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(),</a>
<a class="sourceLine" id="cb2-155" title="155">    <span class="dt">states           =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ht"</span>)),</a>
<a class="sourceLine" id="cb2-156" title="156">    <span class="dt">has_hier_effs    =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb2-157" title="157">    <span class="dt">levels_hier_effs =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">yr =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb2-158" title="158">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-159" title="159"><span class="st">  </span><span class="kw"><a href="../reference/define_star.html">define_impl</a></span>(</a>
<a class="sourceLine" id="cb2-160" title="160">    <span class="kw"><a href="../reference/define_star.html">make_impl_args_list</a></span>(</a>
<a class="sourceLine" id="cb2-161" title="161">      <span class="dt">kernel_names =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"K_yr"</span>, <span class="st">"P_yr"</span>, <span class="st">"F_yr"</span>),</a>
<a class="sourceLine" id="cb2-162" title="162">      <span class="dt">int_rule     =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"midpoint"</span>, <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb2-163" title="163">      <span class="dt">dom_start    =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"ht"</span>, <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb2-164" title="164">      <span class="dt">dom_end      =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"ht"</span>, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb2-165" title="165">    )</a>
<a class="sourceLine" id="cb2-166" title="166">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-167" title="167"><span class="st">  </span><span class="kw"><a href="../reference/define_star.html">define_domains</a></span>(<span class="dt">ht =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.2</span>, <span class="dv">40</span>, <span class="dv">100</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-168" title="168"><span class="st">  </span><span class="kw"><a href="../reference/make_ipm.html">make_ipm</a></span>(<span class="dt">usr_funs =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">inv_logit   =</span> inv_logit,</a>
<a class="sourceLine" id="cb2-169" title="169">                           <span class="dt">inv_logit_r =</span> inv_logit_r,</a>
<a class="sourceLine" id="cb2-170" title="170">                           <span class="dt">pois_r      =</span> pois_r))</a>
<a class="sourceLine" id="cb2-171" title="171"></a>
<a class="sourceLine" id="cb2-172" title="172">lambda_ipmr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/lambda.html">lambda</a></span>(monocarp_sys, </a>
<a class="sourceLine" id="cb2-173" title="173">                      <span class="dt">comp_method =</span> <span class="st">'eigen'</span>,</a>
<a class="sourceLine" id="cb2-174" title="174">                      <span class="dt">type_lambda =</span> <span class="st">'all'</span>)</a>
<a class="sourceLine" id="cb2-175" title="175"></a>
<a class="sourceLine" id="cb2-176" title="176"></a>
<a class="sourceLine" id="cb2-177" title="177"><span class="co"># define functions for target ipm ---------</span></a>
<a class="sourceLine" id="cb2-178" title="178"></a>
<a class="sourceLine" id="cb2-179" title="179"></a>
<a class="sourceLine" id="cb2-180" title="180"><span class="co"># Survival - logistic regression</span></a>
<a class="sourceLine" id="cb2-181" title="181">s &lt;-<span class="st"> </span><span class="cf">function</span>(sv1, params, r_effect) {</a>
<a class="sourceLine" id="cb2-182" title="182">  <span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="op">-</span>(params[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>params[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>sv1 <span class="op">+</span><span class="st"> </span>r_effect))) <span class="op">*</span></a>
<a class="sourceLine" id="cb2-183" title="183"><span class="st">    </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">f_r</span>(sv1, params[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>]))</a>
<a class="sourceLine" id="cb2-184" title="184">}</a>
<a class="sourceLine" id="cb2-185" title="185"></a>
<a class="sourceLine" id="cb2-186" title="186"><span class="co"># Growth</span></a>
<a class="sourceLine" id="cb2-187" title="187">g &lt;-<span class="st"> </span><span class="cf">function</span>(sv1, sv2, params, r_effect, L, U) {</a>
<a class="sourceLine" id="cb2-188" title="188">  mu &lt;-<span class="st"> </span>params[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>params[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>sv1 <span class="op">+</span><span class="st"> </span>r_effect</a>
<a class="sourceLine" id="cb2-189" title="189">  ev &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(U, mu, params[<span class="dv">3</span>]) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(L, mu, params[<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb2-190" title="190">  <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span>(sv2, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> params[<span class="dv">3</span>]) <span class="op">/</span><span class="st"> </span>ev</a>
<a class="sourceLine" id="cb2-191" title="191">}</a>
<a class="sourceLine" id="cb2-192" title="192"></a>
<a class="sourceLine" id="cb2-193" title="193"><span class="co"># probability of reproducing</span></a>
<a class="sourceLine" id="cb2-194" title="194">f_r &lt;-<span class="st"> </span><span class="cf">function</span>(sv1, params) {</a>
<a class="sourceLine" id="cb2-195" title="195">  <span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="op">-</span>(params[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>params[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>sv1)))</a>
<a class="sourceLine" id="cb2-196" title="196">}</a>
<a class="sourceLine" id="cb2-197" title="197"></a>
<a class="sourceLine" id="cb2-198" title="198"><span class="co"># offspring production</span></a>
<a class="sourceLine" id="cb2-199" title="199">f_s &lt;-<span class="st"> </span><span class="cf">function</span>(sv1, params, r_effect) {</a>
<a class="sourceLine" id="cb2-200" title="200">  <span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(params[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>params[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>sv1 <span class="op">+</span><span class="st"> </span>r_effect)</a>
<a class="sourceLine" id="cb2-201" title="201">}</a>
<a class="sourceLine" id="cb2-202" title="202"></a>
<a class="sourceLine" id="cb2-203" title="203"><span class="co"># offspring size distribution</span></a>
<a class="sourceLine" id="cb2-204" title="204">f_d &lt;-<span class="st"> </span><span class="cf">function</span>(sv2, params, L, U) {</a>
<a class="sourceLine" id="cb2-205" title="205">  ev &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(U, params[<span class="dv">1</span>], params[<span class="dv">2</span>]) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(L, params[<span class="dv">1</span>], params[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb2-206" title="206">  <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span>(sv2, <span class="dt">mean =</span> params[<span class="dv">1</span>], <span class="dt">sd =</span> params[<span class="dv">2</span>]) <span class="op">/</span><span class="st"> </span>ev</a>
<a class="sourceLine" id="cb2-207" title="207">}</a>
<a class="sourceLine" id="cb2-208" title="208"></a>
<a class="sourceLine" id="cb2-209" title="209"><span class="co"># constructor function for the F kernel</span></a>
<a class="sourceLine" id="cb2-210" title="210">fec &lt;-<span class="st"> </span><span class="cf">function</span>(sv1, sv2, params, r_effect, L, U) {</a>
<a class="sourceLine" id="cb2-211" title="211">  <span class="kw">f_r</span>(sv1, params[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]) <span class="op">*</span><span class="st"> </span><span class="kw">f_s</span>(sv1, params[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>], r_effect) <span class="op">*</span><span class="st"> </span><span class="kw">f_d</span>(sv2, params[<span class="dv">5</span><span class="op">:</span><span class="dv">6</span>], L, U)</a>
<a class="sourceLine" id="cb2-212" title="212">}</a>
<a class="sourceLine" id="cb2-213" title="213"></a>
<a class="sourceLine" id="cb2-214" title="214">b   &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.2</span>, <span class="dv">40</span>, <span class="dt">length.out =</span> <span class="dv">101</span>)</a>
<a class="sourceLine" id="cb2-215" title="215"></a>
<a class="sourceLine" id="cb2-216" title="216">sv1 &lt;-<span class="st"> </span>(b[<span class="dv">2</span><span class="op">:</span><span class="dv">101</span>] <span class="op">+</span><span class="st"> </span>b[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>]) <span class="op">*</span><span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb2-217" title="217"></a>
<a class="sourceLine" id="cb2-218" title="218">domains &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">d2 =</span> sv1, <span class="dt">d1 =</span> sv1))</a>
<a class="sourceLine" id="cb2-219" title="219"></a>
<a class="sourceLine" id="cb2-220" title="220">h   &lt;-<span class="st"> </span>sv1[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>sv1[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb2-221" title="221"></a>
<a class="sourceLine" id="cb2-222" title="222"><span class="co"># repetitive to demonstrate the typical kernel construction process.</span></a>
<a class="sourceLine" id="cb2-223" title="223"></a>
<a class="sourceLine" id="cb2-224" title="224">g_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">g</span>(domains<span class="op">$</span>d2, domains<span class="op">$</span>d1,</a>
<a class="sourceLine" id="cb2-225" title="225">         <span class="dt">params =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(params<span class="op">$</span>g_int,</a>
<a class="sourceLine" id="cb2-226" title="226">                    params<span class="op">$</span>g_slope,</a>
<a class="sourceLine" id="cb2-227" title="227">                    params<span class="op">$</span>sd_g),</a>
<a class="sourceLine" id="cb2-228" title="228">         <span class="dt">r_effect =</span> params<span class="op">$</span>g_r_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb2-229" title="229">         <span class="dt">L =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb2-230" title="230">         <span class="dt">U =</span> <span class="dv">40</span>)</a>
<a class="sourceLine" id="cb2-231" title="231"></a>
<a class="sourceLine" id="cb2-232" title="232">g_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">g</span>(domains<span class="op">$</span>d2, domains<span class="op">$</span>d1,</a>
<a class="sourceLine" id="cb2-233" title="233">         <span class="dt">params =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(params<span class="op">$</span>g_int,</a>
<a class="sourceLine" id="cb2-234" title="234">                    params<span class="op">$</span>g_slope,</a>
<a class="sourceLine" id="cb2-235" title="235">                    params<span class="op">$</span>sd_g),</a>
<a class="sourceLine" id="cb2-236" title="236">         <span class="dt">r_effect =</span> params<span class="op">$</span>g_r_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb2-237" title="237">         <span class="dt">L =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb2-238" title="238">         <span class="dt">U =</span> <span class="dv">40</span>)</a>
<a class="sourceLine" id="cb2-239" title="239"></a>
<a class="sourceLine" id="cb2-240" title="240">g_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">g</span>(domains<span class="op">$</span>d2, domains<span class="op">$</span>d1,</a>
<a class="sourceLine" id="cb2-241" title="241">         <span class="dt">params =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(params<span class="op">$</span>g_int,</a>
<a class="sourceLine" id="cb2-242" title="242">                    params<span class="op">$</span>g_slope,</a>
<a class="sourceLine" id="cb2-243" title="243">                    params<span class="op">$</span>sd_g),</a>
<a class="sourceLine" id="cb2-244" title="244">         <span class="dt">r_effect =</span> params<span class="op">$</span>g_r_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb2-245" title="245">         <span class="dt">L =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb2-246" title="246">         <span class="dt">U =</span> <span class="dv">40</span>)</a>
<a class="sourceLine" id="cb2-247" title="247"></a>
<a class="sourceLine" id="cb2-248" title="248"></a>
<a class="sourceLine" id="cb2-249" title="249">g_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">g</span>(domains<span class="op">$</span>d2, domains<span class="op">$</span>d1,</a>
<a class="sourceLine" id="cb2-250" title="250">         <span class="dt">params =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(params<span class="op">$</span>g_int,</a>
<a class="sourceLine" id="cb2-251" title="251">                    params<span class="op">$</span>g_slope,</a>
<a class="sourceLine" id="cb2-252" title="252">                    params<span class="op">$</span>sd_g),</a>
<a class="sourceLine" id="cb2-253" title="253">         <span class="dt">r_effect =</span> params<span class="op">$</span>g_r_<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb2-254" title="254">         <span class="dt">L =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb2-255" title="255">         <span class="dt">U =</span> <span class="dv">40</span>)</a>
<a class="sourceLine" id="cb2-256" title="256"></a>
<a class="sourceLine" id="cb2-257" title="257">g_<span class="dv">5</span> &lt;-<span class="st"> </span><span class="kw">g</span>(domains<span class="op">$</span>d2, domains<span class="op">$</span>d1,</a>
<a class="sourceLine" id="cb2-258" title="258">         <span class="dt">params =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(params<span class="op">$</span>g_int,</a>
<a class="sourceLine" id="cb2-259" title="259">                    params<span class="op">$</span>g_slope,</a>
<a class="sourceLine" id="cb2-260" title="260">                    params<span class="op">$</span>sd_g),</a>
<a class="sourceLine" id="cb2-261" title="261">         <span class="dt">r_effect =</span> params<span class="op">$</span>g_r_<span class="dv">5</span>,</a>
<a class="sourceLine" id="cb2-262" title="262">         <span class="dt">L =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb2-263" title="263">         <span class="dt">U =</span> <span class="dv">40</span>)</a>
<a class="sourceLine" id="cb2-264" title="264"></a>
<a class="sourceLine" id="cb2-265" title="265">s_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">s</span>(sv1, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(params<span class="op">$</span>s_int, params<span class="op">$</span>s_slope,</a>
<a class="sourceLine" id="cb2-266" title="266">                params<span class="op">$</span>f_r_int, params<span class="op">$</span>f_r_slope), params<span class="op">$</span>s_r_<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-267" title="267">s_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">s</span>(sv1, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(params<span class="op">$</span>s_int, params<span class="op">$</span>s_slope,</a>
<a class="sourceLine" id="cb2-268" title="268">                params<span class="op">$</span>f_r_int, params<span class="op">$</span>f_r_slope), params<span class="op">$</span>s_r_<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb2-269" title="269">s_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">s</span>(sv1, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(params<span class="op">$</span>s_int, params<span class="op">$</span>s_slope,</a>
<a class="sourceLine" id="cb2-270" title="270">                params<span class="op">$</span>f_r_int, params<span class="op">$</span>f_r_slope), params<span class="op">$</span>s_r_<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb2-271" title="271">s_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">s</span>(sv1, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(params<span class="op">$</span>s_int, params<span class="op">$</span>s_slope,</a>
<a class="sourceLine" id="cb2-272" title="272">                params<span class="op">$</span>f_r_int, params<span class="op">$</span>f_r_slope), params<span class="op">$</span>s_r_<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb2-273" title="273">s_<span class="dv">5</span> &lt;-<span class="st"> </span><span class="kw">s</span>(sv1, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(params<span class="op">$</span>s_int, params<span class="op">$</span>s_slope,</a>
<a class="sourceLine" id="cb2-274" title="274">                params<span class="op">$</span>f_r_int, params<span class="op">$</span>f_r_slope), params<span class="op">$</span>s_r_<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb2-275" title="275"></a>
<a class="sourceLine" id="cb2-276" title="276">P_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(s_<span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(g_<span class="dv">1</span>)) <span class="op">*</span><span class="st"> </span>h</a>
<a class="sourceLine" id="cb2-277" title="277">P_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(s_<span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(g_<span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>h</a>
<a class="sourceLine" id="cb2-278" title="278">P_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(s_<span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(g_<span class="dv">3</span>)) <span class="op">*</span><span class="st"> </span>h</a>
<a class="sourceLine" id="cb2-279" title="279">P_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(s_<span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(g_<span class="dv">4</span>)) <span class="op">*</span><span class="st"> </span>h</a>
<a class="sourceLine" id="cb2-280" title="280">P_<span class="dv">5</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(s_<span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(g_<span class="dv">5</span>)) <span class="op">*</span><span class="st"> </span>h</a>
<a class="sourceLine" id="cb2-281" title="281"></a>
<a class="sourceLine" id="cb2-282" title="282"><span class="co"># These are not corrected for eviction, but they probably should be</span></a>
<a class="sourceLine" id="cb2-283" title="283"></a>
<a class="sourceLine" id="cb2-284" title="284">F_<span class="dv">1</span> &lt;-<span class="st"> </span>h <span class="op">*</span><span class="st"> </span><span class="kw">fec</span>(domains<span class="op">$</span>d2, domains<span class="op">$</span>d1,</a>
<a class="sourceLine" id="cb2-285" title="285">               <span class="dt">params =</span> <span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(params[<span class="dv">6</span><span class="op">:</span><span class="dv">11</span>]),</a>
<a class="sourceLine" id="cb2-286" title="286">               <span class="dt">r_effect =</span> params<span class="op">$</span>f_s_r_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb2-287" title="287">               <span class="dt">L =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb2-288" title="288">               <span class="dt">U =</span> <span class="dv">40</span>)</a>
<a class="sourceLine" id="cb2-289" title="289"></a>
<a class="sourceLine" id="cb2-290" title="290">F_<span class="dv">2</span> &lt;-<span class="st"> </span>h <span class="op">*</span><span class="st"> </span><span class="kw">fec</span>(domains<span class="op">$</span>d2, domains<span class="op">$</span>d1,</a>
<a class="sourceLine" id="cb2-291" title="291">               <span class="dt">params =</span> <span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(params[<span class="dv">6</span><span class="op">:</span><span class="dv">11</span>]),</a>
<a class="sourceLine" id="cb2-292" title="292">               <span class="dt">r_effect =</span> params<span class="op">$</span>f_s_r_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb2-293" title="293">               <span class="dt">L =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb2-294" title="294">               <span class="dt">U =</span> <span class="dv">40</span>)</a>
<a class="sourceLine" id="cb2-295" title="295"></a>
<a class="sourceLine" id="cb2-296" title="296">F_<span class="dv">3</span> &lt;-<span class="st"> </span>h <span class="op">*</span><span class="st"> </span><span class="kw">fec</span>(domains<span class="op">$</span>d2, domains<span class="op">$</span>d1,</a>
<a class="sourceLine" id="cb2-297" title="297">               <span class="dt">params =</span> <span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(params[<span class="dv">6</span><span class="op">:</span><span class="dv">11</span>]),</a>
<a class="sourceLine" id="cb2-298" title="298">               <span class="dt">r_effect =</span> params<span class="op">$</span>f_s_r_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb2-299" title="299">               <span class="dt">L =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb2-300" title="300">               <span class="dt">U =</span> <span class="dv">40</span>)</a>
<a class="sourceLine" id="cb2-301" title="301">F_<span class="dv">4</span> &lt;-<span class="st"> </span>h <span class="op">*</span><span class="st"> </span><span class="kw">fec</span>(domains<span class="op">$</span>d2, domains<span class="op">$</span>d1,</a>
<a class="sourceLine" id="cb2-302" title="302">               <span class="dt">params =</span> <span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(params[<span class="dv">6</span><span class="op">:</span><span class="dv">11</span>]),</a>
<a class="sourceLine" id="cb2-303" title="303">               <span class="dt">r_effect =</span> params<span class="op">$</span>f_s_r_<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb2-304" title="304">               <span class="dt">L =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb2-305" title="305">               <span class="dt">U =</span> <span class="dv">40</span>)</a>
<a class="sourceLine" id="cb2-306" title="306">F_<span class="dv">5</span> &lt;-<span class="st"> </span>h <span class="op">*</span><span class="st"> </span><span class="kw">fec</span>(domains<span class="op">$</span>d2, domains<span class="op">$</span>d1,</a>
<a class="sourceLine" id="cb2-307" title="307">               <span class="dt">params =</span> <span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(params[<span class="dv">6</span><span class="op">:</span><span class="dv">11</span>]),</a>
<a class="sourceLine" id="cb2-308" title="308">               <span class="dt">r_effect =</span> params<span class="op">$</span>f_s_r_<span class="dv">5</span>,</a>
<a class="sourceLine" id="cb2-309" title="309">               <span class="dt">L =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb2-310" title="310">               <span class="dt">U =</span> <span class="dv">40</span>)</a>
<a class="sourceLine" id="cb2-311" title="311"></a>
<a class="sourceLine" id="cb2-312" title="312">K_<span class="dv">1</span> &lt;-<span class="st"> </span>(P_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>F_<span class="dv">1</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-313" title="313"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dt">nrow =</span> <span class="dv">100</span>, <span class="dt">ncol =</span> <span class="dv">100</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-314" title="314">K_<span class="dv">2</span> &lt;-<span class="st"> </span>(P_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>F_<span class="dv">2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-315" title="315"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dt">nrow =</span> <span class="dv">100</span>, <span class="dt">ncol =</span> <span class="dv">100</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-316" title="316">K_<span class="dv">3</span> &lt;-<span class="st"> </span>(P_<span class="dv">3</span> <span class="op">+</span><span class="st"> </span>F_<span class="dv">3</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-317" title="317"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dt">nrow =</span> <span class="dv">100</span>, <span class="dt">ncol =</span> <span class="dv">100</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-318" title="318">K_<span class="dv">4</span> &lt;-<span class="st"> </span>(P_<span class="dv">4</span> <span class="op">+</span><span class="st"> </span>F_<span class="dv">4</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-319" title="319"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dt">nrow =</span> <span class="dv">100</span>, <span class="dt">ncol =</span> <span class="dv">100</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-320" title="320">K_<span class="dv">5</span> &lt;-<span class="st"> </span>(P_<span class="dv">5</span> <span class="op">+</span><span class="st"> </span>F_<span class="dv">5</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-321" title="321"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dt">nrow =</span> <span class="dv">100</span>, <span class="dt">ncol =</span> <span class="dv">100</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-322" title="322"></a>
<a class="sourceLine" id="cb2-323" title="323">sys &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">K_1 =</span> K_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb2-324" title="324">            <span class="dt">K_2 =</span> K_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb2-325" title="325">            <span class="dt">K_3 =</span> K_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb2-326" title="326">            <span class="dt">K_4 =</span> K_<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb2-327" title="327">            <span class="dt">K_5 =</span> K_<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb2-328" title="328"></a>
<a class="sourceLine" id="cb2-329" title="329">eigen_sys &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(sys, eigen)</a>
<a class="sourceLine" id="cb2-330" title="330"></a>
<a class="sourceLine" id="cb2-331" title="331">lambdas &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">vapply</a></span>(eigen_sys, <span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/base/complex.html">Re</a></span>(x<span class="op">$</span>values[<span class="dv">1</span>]), <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span>(<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb2-332" title="332">ws      &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">vapply</a></span>(eigen_sys, <span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/base/complex.html">Re</a></span>(x<span class="op">$</span>vectors[ , <span class="dv">1</span>]), <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span>(<span class="dv">100</span>))</a>
<a class="sourceLine" id="cb2-333" title="333"></a>
<a class="sourceLine" id="cb2-334" title="334"></a>
<a class="sourceLine" id="cb2-335" title="335"></a>
<a class="sourceLine" id="cb2-336" title="336"></a>
<a class="sourceLine" id="cb2-337" title="337">lambda_ipmr <span class="op">-</span><span class="st"> </span>lambdas</a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#the-simple-density-independent-deterministic-model-from-the-readme">The simple, density-independent, deterministic model from the README</a></li>
      <li><a href="#simple-density-independent-stochastic-kernel-resampled-model-from-the-readme">Simple density independent stochastic kernel resampled model from the README</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/levisc8">Sam Levin</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
