<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create iteration kernels from an IPM object — format_mega_matrix • ipmr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create iteration kernels from an IPM object — format_mega_matrix" />
<meta property="og:description" content="Creates iteration kernels for IPMs. ipmr does not create
these to iterate models, but they may be useful for further analyses." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ipmr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="divider"></li>
    <li class="dropdown-header">Introduction to ipmr</li>
    <li>
      <a href="../articles/ipmr-introduction.html">Introduction to ipmr</a>
    </li>
    <li>
      <a href="../articles/general-ipms.html">General IPMs</a>
    </li>
    <li>
      <a href="../articles/hierarchical-notation.html">Hierarchical Notation</a>
    </li>
    <li>
      <a href="../articles/age_x_size.html">Age-Size IPMs</a>
    </li>
    <li>
      <a href="../articles/density-dependence.html">Density Dependent IPMs</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Generic Functions</li>
    <li>
      <a href="../articles/generic-funs.html">List of Generic and Helper Functions in ipmr</a>
    </li>
    <li>
      <a href="../articles/generic-progress.html">Generic Progress</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">proto_ipm Overview</li>
    <li>
      <a href="../articles/proto-ipms.html">proto_ipm Data Structure</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/levisc8/ipmr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create iteration kernels from an IPM object</h1>
    <small class="dont-index">Source: <a href='https://github.com/levisc8/ipmr/blob/master/R/utils-export.R'><code>R/utils-export.R</code></a></small>
    <div class="hidden name"><code>make_iter_kernel.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Creates iteration kernels for IPMs. <code>ipmr</code> does not create
these to iterate models, but they may be useful for further analyses.</p>
    </div>

    <pre class="usage"><span class='fu'>format_mega_matrix</span><span class='op'>(</span><span class='va'>ipm</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for default</span>
<span class='fu'>format_mega_matrix</span><span class='op'>(</span><span class='va'>ipm</span>, <span class='va'>mega_mat</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for age_x_size_ipm</span>
<span class='fu'>format_mega_matrix</span><span class='op'>(</span><span class='va'>ipm</span>, <span class='va'>name_ps</span>, <span class='va'>f_forms</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>make_iter_kernel</span><span class='op'>(</span><span class='va'>ipm</span>, mega_mat <span class='op'>=</span> <span class='cn'>NULL</span>, name_ps <span class='op'>=</span> <span class='cn'>NULL</span>, f_forms <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>ipm</th>
      <td><p>Output from <code>make_ipm</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments passed to methods.</p></td>
    </tr>
    <tr>
      <th>mega_mat</th>
      <td><p>A vector with symbols, I's, and/or 0s representing the matrix blocks.
They should be specified in ROW MAJOR order! Can also be a character
string specifying the call. Hierarchical syntax is supported. When used,
<code>format_mega_matrix</code> will produce as many mega-matrices as there are
combinations of <code>levels_hier_effs</code> in the <code>proto_ipm</code>.</p></td>
    </tr>
    <tr>
      <th>name_ps</th>
      <td><p>The prefix(es) for the kernel name that correspond to survival
and growth/maturation of existing individuals. For the model
<code>K = P_age + F_age</code>, this would be <code>"P"</code>. Only applies to
age X size models. The <code>"_age"</code> suffix is appended automatically, so
does not need to be supplied.</p></td>
    </tr>
    <tr>
      <th>f_forms</th>
      <td><p>The names of the kernels that correspond to production of new
individuals, and possibly, how they are combined. For example, a model that
includes sexual (with an "F" kernel) and asexual reproduction (with a "C" kernel),
this would be <code>"F + C"</code>. If data come from multiple sites or years,
then this information is supplied using the suffix syntax (i.e.
<code>f_forms = "F_yr + C_yr"</code>). Only applies to age X size models. The
<code>"_age"</code> suffix is appended automatically, so does not need to be
supplied.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list containing a large matrix or many large matrices (when used with
hierarchical syntax). The names in the former case will be <code>"mega_matrix"</code>
and in the latter case, <code>"mega_matrix_&lt;hier_effs&gt;"</code> with the levels of the
hierarchical effects substituted in.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>ipmr</code> does not generate complete iteration kernels, and uses
sub-kernels to iterate models. However, some further analyses are just easier
to code with a complete iteration kernel. This handles constructing those for
simple and general models of all forms. <code>format_mega_matrix</code> is used
internally by <code>make_iter_kernel</code> for general IPMs.</p>
<p><code>I</code> and <code>0</code> represent identity matrices and 0 matrices,
respectively. They can be used to fill in blocks that represent either, without
having to create those separately and append them to the model object. The function
will work out the correct dimensions for both internally, and there is no
restriction on the number that may be used in a given call.</p>
<p>For <code>age_size_ipm</code>s, the correct form of <code>mega_mat</code> is generated
internally by creating sub-diagonal matrices for the <code>name_ps</code> kernels,
and a top row using the <code>f_forms</code>. If hierarchical effects are part of the
model, the suffixes should be attached to the <code>name_ps, f_forms</code> in the
function arguments, and the correct block matrices will be generated internally.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>gen_di_det_ex</span><span class='op'>)</span>

<span class='va'>big_k</span> <span class='op'>&lt;-</span> <span class='fu'>make_iter_kernel</span><span class='op'>(</span><span class='va'>gen_di_det_ex</span>,
                            mega_mat <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>go_discrete</span>,
                                         <span class='va'>leave_discrete</span>, <span class='va'>P</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>char_call</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='st'>"go_discrete"</span>, <span class='st'>"leave_discrete"</span>, <span class='st'>"P"</span><span class='op'>)</span>

<span class='va'>big_k_c</span> <span class='op'>&lt;-</span> <span class='fu'>make_iter_kernel</span><span class='op'>(</span><span class='va'>gen_di_det_ex</span>, mega_mat <span class='op'>=</span> <span class='va'>char_call</span><span class='op'>)</span>

<span class='co'># Now, with an Identity matrix instead of a 0</span>

<span class='va'>big_k</span> <span class='op'>&lt;-</span> <span class='fu'>make_iter_kernel</span><span class='op'>(</span><span class='va'>gen_di_det_ex</span>,
                            mega_mat <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>I</span>, <span class='va'>go_discrete</span>,
                                         <span class='va'>leave_discrete</span>, <span class='va'>P</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># For simple IPMs with no hierarchical effects, this computes the sum of</span>
<span class='co'># the sub-kernels (i.e. K = P + F)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>sim_di_det_ex</span><span class='op'>)</span>

<span class='va'>simple_k</span> <span class='op'>&lt;-</span> <span class='fu'>make_iter_kernel</span><span class='op'>(</span><span class='va'>sim_di_det_ex</span><span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://github.com/levisc8'>Sam Levin</a>, Aldo Compagnoni, Dylan Childs, Sanne Evers, Roberto Salguero-Gomez, Tiffany Knight.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


